"use strict";function postData(e){let t=new FormData(e);const n=$(e).find('button[type="submit"]'),a=n.find(".loader");$.ajax({url:route,type:"POST",data:t,processData:!1,contentType:!1,dataType:"json",beforeSend:function(){n.prop("disabled",!0),a.removeClass("hidden")}}).done((function(t,s,o){n.prop("disabled",!1),a.addClass("hidden");const r=t?.data?.meta||{};$.each(r,(function(e,t){const n=$("#"+e);n.length&&n.val(t)}));const i=!0===t?.connected,d=t?.connection_message||"",l=$(e).find('input[name="type"]').val();"whatsapp"===l?updateConnectionStatus("#whatsapp-form",i,d):"telegram"===l&&updateConnectionStatus("#telegram-form",i,d),i?toastMixin.fire({title:d||jsLang("Saved successfully!"),icon:"success"}):d?toastMixin.fire({title:d,icon:"error"}):toastMixin.fire({title:jsLang("Saved successfully!"),icon:"success"})})).fail((function(t,s,o){n.prop("disabled",!1),a.addClass("hidden");const r=$(e).find('input[name="type"]').val();"whatsapp"===r?updateConnectionStatus("#whatsapp-form",!1,""):"telegram"===r&&updateConnectionStatus("#telegram-form",!1,"");const i=t.responseJSON?.error||t.responseJSON?.message||jsLang("An error occurred");toastMixin.fire({title:i,icon:"error"})}))}function updateConnectionStatus(e,t,n){let a;"#whatsapp-form"===e?a=$("#whatsapp-webhook-status"):"#telegram-form"===e&&(a=$("#telegram-webhook-status")),a.length&&(a.removeClass("bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hidden"),t?(a.addClass("inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400"),a.html(`\n                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />\n                </svg>\n                ${jsLang("Connected")}\n            `)):(a.addClass("inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"),a.html(`\n                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />\n                </svg>\n                ${jsLang("Not Connected")}\n            `)))}$(document).on("submit","#whatsapp-form",(function(e){e.preventDefault(),postData(this)})),$(document).on("submit","#telegram-form",(function(e){e.preventDefault(),postData(this)})),$(document).on("click",".toggle-password-btn",(function(){const e=$(this),t=e.closest(".relative").find('input[type="password"], input[type="text"]'),n=e.find("svg:first"),a=e.find("svg:last"),s="password"===t.attr("type");t.attr("type",s?"text":"password"),n.toggleClass("hidden",s),a.toggleClass("hidden",!s)})),$(document).on("click",".copy-webhook-btn",(function(){const e=$(this),t=e.siblings('input[type="url"]').val().trim(),n=e.find(".copy-icon"),a=e.find(".check-icon");t&&navigator.clipboard.writeText(t).then((()=>{n.addClass("hidden"),a.removeClass("hidden"),e.addClass("bg-green-100 dark:bg-green-700"),setTimeout((()=>{n.removeClass("hidden"),a.addClass("hidden"),e.removeClass("bg-green-100 dark:bg-green-700")}),1500)}))}));